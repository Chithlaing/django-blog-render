{% extends "blog/base.html" %}
{% block content %}
    <style>
        table thead th {
            position: sticky;
            top: 0;
            background: white;   /* header ကျရင် background ပြန်ဖြစ်အောင် */
            z-index: 10;         /* scroll ပြုလုပ်တဲ့ rowတွေက header ကို မဖုံးအောင် */
            padding: 10px 5px;
        }

        .table-container {
            max-height: 600px;
            overflow-y: auto;
            margin: 2px 2px;
        }
    </style>
    <!-- Search Form -->
    <div class="mb-6">
        <form method="GET" action="{% url 'blog-table' %}" class="form-inline">
            <div class="input-group">
                <input type="text"
                       name="q"
                       class="form-control me-2"
                       placeholder="Search by title, author, or date..."
                       value="{{ search_query|default:'' }}">
                <div class="input-group-append">
                    <button type="submit" class="btn btn-primary">Search</button>
                    {% if search_query %}
                        <a href="{% url 'blog-table' %}" class="btn btn-secondary">Clear</a>
                    {% endif %}
                </div>
            </div>
            <p class="h3 text-info">Found {{ posts.count }} posts</p>
        </form>
    </div>

    <div class="table-container ">
        <table class="table table-striped table-hover">
            <thead>
            <tr>
                <th scope="col">#</th>
                <th scope="col">ID</th>
                <th scope="col">Author</th>
                <th scope="col">Date Posted</th>
                <th scope="col">Title</th>
                <th scope="col">Actions</th>
            </tr>
            </thead>
            <tbody>
            {% for post in posts %}
                <tr>
                    <th scope="row">{{ forloop.counter }}</th>  <!-- အမှတ်စဉ် -->
                    <td>{{ post.id }}</td>  <!-- author က User object ဆိုရင် -->
                    <td>
                        <a href="{% url 'user-posts' post.author.username %}" class="text-dark">
                            {{ post.author.username }}
                        </a>
                    </td>  <!-- author က User object ဆိုရင် -->
                    <td>{{ post.date_posted|date:"F d, Y" }}</td>  <!-- date format -->
                    <td>
                        <a href="{% url 'post-detail' post.id %}" class="text-dark">
                            {{ post.title }}
                        </a>
                    </td>
                    <td>
                        <a href="{% url 'post-update' post.id %}" class="btn btn-sm btn-warning">Edit</a>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="5" class="text-center">No posts available.</td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
{% endblock %}